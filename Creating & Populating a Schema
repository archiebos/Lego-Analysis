-- CREATING A NEW SCHEMA

create schema til_portfolio_projects.Archie_Boswell;

-- CREATING NEW TABLES AND POPULATING THEM

create table til_portfolio_projects.Archie_Boswell.LEGO_Colours (

ID Number(38,0),
Name Varchar(255),
RGB varchar(255),
IS_Trans varchar(255),

);

INSERT INTO til_portfolio_projects.Archie_Boswell.LEGO_Colours(
SELECT * FROM TIL_PORTFOLIO_PROJECTS.STAGING.LEGO_COLORS
);

create table til_portfolio_projects.Archie_Boswell.LEGO_INVENTORIES (

ID Number(38,0),
VERSION NUMBER(38,0),
SET_NUM VARCHAR(255));

INSERT INTO til_portfolio_projects.Archie_Boswell.LEGO_INVENTORIES(
SELECT * FROM TIL_PORTFOLIO_PROJECTS.STAGING.LEGO_INVENTORIES
);

create table til_portfolio_projects.Archie_Boswell.LEGO_INVENTORIES_PARTS (

INVENTORY_ID NUMBER(38,0),
PART_NUM VARCHAR(255),
COLOUR_ID NUMBER(38,0),
QUANTITY NUMBER(38,0),
IS_SPARE VARCHAR(255));

INSERT INTO til_portfolio_projects.Archie_Boswell.LEGO_INVENTORIES_PARTS(
SELECT * FROM TIL_PORTFOLIO_PROJECTS.STAGING.LEGO_INVENTORY_PARTS
);

create table til_portfolio_projects.Archie_Boswell.LEGO_INVENTORIES_SETS ( 

INVENTORY_ID NUMBER(38,0),
SET_NUM VARCHAR(255),
QUANTITY NUMBER(38,0));

INSERT INTO til_portfolio_projects.Archie_Boswell.LEGO_INVENTORIES_SETS(
SELECT * FROM TIL_PORTFOLIO_PROJECTS.STAGING.LEGO_INVENTORY_SETS
);

create table til_portfolio_projects.Archie_Boswell.LEGO_PARTS (

PART_NUM VARCHAR(255),
NAME VARCHAR(255),
PART_CAT_ID NUMBER(38,0)
);

INSERT INTO til_portfolio_projects.Archie_Boswell.LEGO_PARTS(
SELECT * FROM TIL_PORTFOLIO_PROJECTS.STAGING.LEGO_PARTS
);

create table til_portfolio_projects.Archie_Boswell.LEGO_PARTS_CATEGORIES(
ID NUMBER(38,0),
NAME VARCHAR(255)
);

INSERT INTO til_portfolio_projects.Archie_Boswell.LEGO_PARTS_CATEGORIES(
SELECT * FROM TIL_PORTFOLIO_PROJECTS.STAGING.LEGO_PART_CATEGORIES
);

create table til_portfolio_projects.Archie_Boswell.LEGO_SETS(
SET_NUM VARCHAR(255),
Name Varchar(255),
YEAR NUMBER(38,0),
THEME_ID NUMBER(38,0),
NUM_PARTS NUMBER(38,0));

INSERT INTO til_portfolio_projects.Archie_Boswell.LEGO_SETS(
SELECT * FROM TIL_PORTFOLIO_PROJECTS.STAGING.LEGO_SETS
);

create table til_portfolio_projects.Archie_Boswell.LEGO_THEMES(
ID NUMBER(38,0),
NAME VARCHAR(255),
PARENT_ID NUMBER(38,0));

INSERT INTO til_portfolio_projects.Archie_Boswell.LEGO_THEMES(
SELECT * FROM TIL_PORTFOLIO_PROJECTS.STAGING.LEGO_THEMES
);


--ADDING PRIMARY KEYS

ALTER TABLE LEGO_COLOURS ADD PRIMARY KEY (ID);
ALTER TABLE LEGO_INVENTORIES_PARTS ADD PRIMARY KEY (INVENTORY_ID);
ALTER TABLE LEGO_INVENTORIES_SETS ADD PRIMARY KEY (INVENTORY_ID);
ALTER TABLE LEGO_INVENTORIES ADD PRIMARY KEY (ID);
ALTER TABLE LEGO_PARTS ADD PRIMARY KEY (PART_NUM);
ALTER TABLE LEGO_SETS ADD PRIMARY KEY (SET_NUM);
ALTER TABLE LEGO_THEMES ADD PRIMARY KEY (ID);
ALTER TABLE LEGO_PARTS_CATEGORIES ADD PRIMARY KEY (ID);

-- ADDING FOREIGN KEYS

ALTER TABLE LEGO_INVENTORIES_PARTS ADD
FOREIGN KEY (PART_NUM) REFERENCES LEGO_PARTS(PART_NUM);
ALTER TABLE LEGO_INVENTORIES_PARTS ADD
FOREIGN KEY (COLOUR_ID) REFERENCES LEGO_COLOURS(ID);

ALTER TABLE LEGO_INVENTORIES_SETS ADD
FOREIGN KEY (SET_NUM) REFERENCES LEGO_SETS(SET_NUM);

ALTER TABLE LEGO_INVENTORIES ADD
FOREIGN KEY (SET_NUM) REFERENCES LEGO_SETS(SET_NUM);

ALTER TABLE LEGO_PARTS ADD
FOREIGN KEY (PART_CAT_ID) REFERENCES LEGO_PARTS_CATEGORIES(ID);
